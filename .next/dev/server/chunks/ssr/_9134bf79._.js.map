{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/alam/projetos/colibri/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient };\n\nexport const prisma =\n  globalForPrisma.prisma ||\n  new PrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY;AAElB,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 17, "column": 0}, "map": {"version":3,"sources":["file:///home/alam/projetos/colibri/actions.ts"],"sourcesContent":["'use server';\n\nimport { z } from 'zod';\nimport { prisma } from './lib/prisma';   // ✅ import nomeado\nimport { revalidatePath } from 'next/cache';\nimport { Specialty, Role, AppointmentStatus } from '@prisma/client';\n\n\n// Schema validado para a jornada da Life Clinic\nconst AppointmentSchema = z.object({\n  name: z.string().min(2, \"O nome deve ter pelo menos 2 caracteres\"),\n  email: z.string().email(\"E-mail inválido\"),\n  specialty: z.nativeEnum(Specialty),\n});\n\nexport async function getDashboardData() {\n  const [gynecologists, specialists, supplies, appointmentsCount] = await Promise.all([\n    prisma.professional.findMany({\n      where: { specialty: Specialty.GYNECOLOGIST },\n      include: { user: true },\n    }),\n    prisma.professional.findMany({\n      where: { specialty: Specialty.OBSTETRICIAN },\n      include: { user: true },\n    }),\n    prisma.supply.findMany({\n      orderBy: { quantity: 'asc' },\n      take: 5\n    }),\n    prisma.appointment.count(),\n  ]);\n\n  return { gynecologists, specialists, supplies, appointmentsCount };\n}\n\nexport async function createAppointment(formData: FormData) {\n  const validatedFields = AppointmentSchema.safeParse({\n    name: formData.get('name'),\n    email: formData.get('email'),\n    specialty: formData.get('specialty'),\n  });\n\n  if (!validatedFields.success) {\n    return { error: validatedFields.error.flatten().fieldErrors };\n  }\n\n  try {\n    const targetSpecialty = validatedFields.data.specialty;\n\n    // 2. Busca um profissional disponível (regra simples: o primeiro encontrado)\n    const professional = await prisma.professional.findFirst({\n      where: { specialty: targetSpecialty }\n    });\n\n    if (!professional) {\n      return { error: \"Nenhum profissional disponível nesta categoria no momento.\" };\n    }\n\n    // 3. Cria o agendamento e o usuário (se não existir)\n    await prisma.appointment.create({\n      data: {\n        date: new Date(), // Define data atual para \"Fila de Espera\"\n        status: AppointmentStatus.PENDING,\n        notes: `Solicitação via Dashboard. Especialidade: ${validatedFields.data.specialty}`,\n        professional: { connect: { id: professional.id } },\n        patient: {\n          connectOrCreate: {\n            where: { email: validatedFields.data.email },\n            create: {\n              email: validatedFields.data.email,\n              name: validatedFields.data.name,\n              role: Role.PATIENT\n            },\n          },\n        },\n      },\n    });\n\n    revalidatePath('/dashboard');\n    return { success: true, message: \"Solicitação enviada com sucesso!\" };\n  } catch (e) {\n    console.error(e);\n    return { error: \"Erro ao conectar com o banco de dados.\" };\n  }\n}\n\n// Novo Schema para o BookingModal\nconst BookingSchema = z.object({\n  name: z.string().min(2, \"Nome é obrigatório\"),\n  email: z.string().email(\"E-mail inválido\"),\n  professionalId: z.string().min(1, \"Selecione um médico\"),\n  date: z.string().min(1, \"Selecione uma data\"),\n});\n\nexport async function scheduleAppointment(formData: FormData) {\n  const rawData = {\n    name: formData.get('name'),\n    email: formData.get('email'),\n    professionalId: formData.get('professionalId'),\n    date: formData.get('date'),\n  };\n\n  const validated = BookingSchema.safeParse(rawData);\n\n  if (!validated.success) {\n    return { error: validated.error.flatten().fieldErrors };\n  }\n\n  try {\n    await prisma.appointment.create({\n      data: {\n        date: new Date(validated.data.date),\n        status: AppointmentStatus.PENDING,\n        notes: \"Agendamento via BookingModal (Ciclo Completo)\",\n        professional: { connect: { id: Number(validated.data.professionalId) } },\n        patient: {\n          connectOrCreate: {\n            where: { email: validated.data.email },\n            create: {\n              email: validated.data.email,\n              name: validated.data.name,\n              role: Role.PATIENT\n            },\n          },\n        },\n      },\n    });\n\n    revalidatePath('/dashboard');\n    return { success: true };\n  } catch (e) {\n    console.error(e);\n    return { error: \"Erro ao processar agendamento.\" };\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///home/alam/projetos/colibri/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getDashboardData as '00d11af6933d4d7ffe44d5e5dcab6df45e4328278a'} from 'ACTIONS_MODULE0'\nexport {createAppointment as '409695d084874d54bb7591261994339246d267f57f'} from 'ACTIONS_MODULE0'\nexport {scheduleAppointment as '40c417288b7821425586f497925172b6fd3c99f137'} from 'ACTIONS_MODULE0'\nexport {createAppointment as '409695d084874d54bb7591261994339246d267f57f'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}